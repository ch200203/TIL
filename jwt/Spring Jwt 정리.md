## Spring Security & JWT 정리


1. Session vs Token
	- Session
			1) 세션은 데이터베이스 서버에 저장
			2) 세션은 서버에서 저장/관리하기 때문에 상대적으로 온전한 상태를 유지하기 유리하다.
			3) 하지만 여전히 공격의 위험이 있기에 유효기간, HttpOnly, Secure 옵션을 주어 쿠키등에 저장하여 관리
			4) 다중 접속자 발생시 과부하가 걸릴 수 있음, 서버가 여러대라면 세션을 쓰기 복잡함
	
	- Token
			1) 클라이언트 측에만 저장
			2) 토큰은 로컬스토리지, 쿠키 등에 저장되기 때문에 공격에 노출될 가능성 ↑
				-> 따라서 토큰에는 민감한 정보 X, 유효기간을 짧게 설정, refresh token 이용
			3) 토큰 방식을 사용하는 경우 세션 사용방식에 비해 비용절감, 추가 서버 없이 인증/인가 처리 가능.
			

2. JWT 구조
	- Header, Playload, Signature 3부분으로 나뉘어 있음. 
		1) Header 
			typ : 토큰의 타입 지정
			alg : 해싱알고리즘을 지정
			
		2) Payload
			Payload 부분에는 토큰에 담을 정보가 담겨있다.
			여기에 담는 정보의 한 ‘조각’ 을 클레임(Claim) 이라고 부르고, 이는 Json(Key/Value) 형태
			Claim의 종류
			- 등록된 Claim
			- public Claim
			- prviate Claim
			
		3) Signature
			- 서명은 토큰을 인코딩하거나 유효성을 검증할 때 사용하는 고유한 암호화 코드
				- 위에서 만든 헤더와 페이로드의 값을 BASE64로 인코딩하고 
				- 비밀키를 이용해 헤더에서 정의한 알고리즘으로 해싱 
				- 다시 BASE64로 인코딩하여 생성
			
3. JWT 장/단점
	- 장점
			- 사용자 인증에 필요한 모든 정보는 토큰자체에 포함하여 별도의 인증저장소가 필요하지 X
			- 쿠키를 전달하지 않아도 되므로 쿠키사용에서의 취약점 모두 사라짐
			- 트래픽 부담 ↓
			- REST 서비스로 제공가능
			- 내장된 만료
	- 단점
			- Self-contained : 토큰 자체에 정보를 담고있어 양날의 검임
			- 토큰의 Playload에 3종류의 Claim을 저장하여 토큰의 길이가 늘어날 수 있음
			- Payload 인코딩 : 암호화가 되어있지 않아 중요데이터를 넣지 않아야함
			- Stateless : JWT는 토큰 임의 삭제불가. -> 만료시간 필요
			- 토큰은 클라이언트 측에서 관리되어 토큰을 저장하여야 함.
	